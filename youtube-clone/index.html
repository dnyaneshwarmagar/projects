<!DOCTYPE html>
<html lang="en">
  <head>
    <title>YouTube</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="styles/reset.css" />
    <link rel="stylesheet" type="text/css" href="styles/main.css" />
    <meta name="viewport" content="width=device-width, initial-scale=0.6" />
    <style></style>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <div class="header__logo">
          <a href="#">
            <img
              src="images/header/hamburger.png"
              alt="navigation button"
              class="header__hamburger-logo"
            />
          </a>
          <a href="#">
            <img
              src="images/header/yt-logo.png"
              alt="YouTube logo"
              class="header__yt-logo"
            />
          </a>
        </div>
        <div class="search">
          <form>
            <input
              type="text"
              name="search"
              id="search__input"
              placeholder="Search"
            />
            <a href="#">
              <img
                src="images/header/search.png"
                alt="Search Icon"
                class="search__icon"
                onclick="searchVideos()"
              />
            </a>
          </form>
        </div>
        <div class="header__icons header__logo">
          <a href="#">
            <img
              src="images/header/grid.png"
              alt="grid icon"
              class="header__icons--grid"
            />
          </a>
          <a href="#">
            <img
              src="images/header/upload.png"
              alt="grid icon"
              class="header__icons--upload"
            />
          </a>
          <a href="#">
            <img
              src="images/header/bell.png"
              alt="grid icon"
              class="header__icons--bell"
            />
          </a>
          <a href="#">
            <img
              src="images/header/profile-placeholder.png"
              alt="grid icon"
              class="header__icons--profile"
            />
          </a>
        </div>
      </header>
    </div>
    <div class="container">
      <div class="sidebar">
        <div>
          <yt-icon
            id="icon"
            class="guide-icon style-scope ytd-mini-guide-entry-renderer"
            ><svg
              viewBox="0 0 24 24"
              preserveAspectRatio="xMidYMid meet"
              focusable="false"
              class="style-scope yt-icon"
              style="
                pointer-events: none;
                display: block;
                width: 50%;
                height: 50%;
              "
            >
              <g class="style-scope yt-icon">
                <path
                  d="M4,10V21h6V15h4v6h6V10L12,3Z"
                  class="style-scope yt-icon"
                ></path>
              </g></svg
          ></yt-icon>
          <p>Home</p>
        </div>
        <div>
          <yt-icon
            id="icon"
            class="guide-icon style-scope ytd-mini-guide-entry-renderer"
            ><svg
              viewBox="0 0 24 24"
              preserveAspectRatio="xMidYMid meet"
              focusable="false"
              class="style-scope yt-icon"
              style="
                pointer-events: none;
                display: block;
                width: 50%;
                height: 50%;
              "
            >
              <g class="style-scope yt-icon">
                <path
                  d="M9.8,9.8l-3.83,8.23l8.23-3.83l3.83-8.23L9.8,9.8z M13.08,12.77c-0.21,0.29-0.51,0.48-0.86,0.54 c-0.07,0.01-0.15,0.02-0.22,0.02c-0.28,0-0.54-0.08-0.77-0.25c-0.29-0.21-0.48-0.51-0.54-0.86c-0.06-0.35,0.02-0.71,0.23-0.99 c0.21-0.29,0.51-0.48,0.86-0.54c0.35-0.06,0.7,0.02,0.99,0.23c0.29,0.21,0.48,0.51,0.54,0.86C13.37,12.13,13.29,12.48,13.08,12.77z M12,3c4.96,0,9,4.04,9,9s-4.04,9-9,9s-9-4.04-9-9S7.04,3,12,3 M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2 L12,2z"
                  class="style-scope yt-icon"
                ></path>
              </g></svg
          ></yt-icon>
          <p>Explore</p>
        </div>
        <div>
          <yt-icon
            id="icon"
            class="guide-icon style-scope ytd-mini-guide-entry-renderer"
            ><svg
              viewBox="0 0 24 24"
              preserveAspectRatio="xMidYMid meet"
              focusable="false"
              class="style-scope yt-icon"
              style="
                pointer-events: none;
                display: block;
                width: 50%;
                height: 50%;
              "
            >
              <g class="style-scope yt-icon">
                <path
                  d="M10,18v-6l5,3L10,18z M17,3H7v1h10V3z M20,6H4v1h16V6z M22,9H2v12h20V9z M3,10h18v10H3V10z"
                  class="style-scope yt-icon"
                ></path>
              </g></svg
          ></yt-icon>
          <p style="margin-left: -9px">Subscriptions</p>
        </div>
        <div>
          <yt-icon
            id="icon"
            class="guide-icon style-scope ytd-mini-guide-entry-renderer"
            ><svg
              viewBox="0 0 26 29"
              preserveAspectRatio="xMidYMid meet"
              focusable="false"
              class="style-scope yt-icon"
              style="
                pointer-events: none;
                display: block;
                width: 50%;
                height: 50%;
              "
            >
              <g class="style-scope yt-icon">
                <path
                  d="M11,7l6,3.5L11,14V7L11,7z M18,20H4V6H3v15h15V20z M21,18H6V3h15V18z M7,17h13V4H7V17z"
                  class="style-scope yt-icon"
                ></path>
              </g></svg
          ></yt-icon>
          <p>Library</p>
        </div>
      </div>
      <div id="videos"></div>
    </div>
  </body>
</html>
<script>
  let videos = document.getElementById("videos");

  window.onload = async function getPopular() {
    let res = await fetch(
      `https://youtube.googleapis.com/youtube/v3/videos?part=snippet%2CcontentDetails%2Cstatistics&chart=mostPopular&regionCode=IN&key=AIzaSyChCL69Vu1TClLvQ8tE0kFjtPrc6w_rOz8&maxResults=20&type=video`
    );
    let data = await res.json();
    console.log("data:", data);
    appendVideos(data.items);
  };

  async function searchVideos() {
    let query = document.getElementById("search__input").value;
    let res = await fetch(
      `https://youtube.googleapis.com/youtube/v3/search?q=${query}&type=video&key=AIzaSyChCL69Vu1TClLvQ8tE0kFjtPrc6w_rOz8&maxResults=20&part=snippet`
    );

    let data = await res.json();

    console.log("data:", data);

    appendVideos(data.items);
  }

  function appendVideos(video_array) {
    videos.innerHTML = null;

    video_array.forEach(({ snippet, id, id: { videoId } }) => {
      // console.log("snippet:", snippet);

      let div = document.createElement("div");

      let url = snippet.thumbnails.medium.url;
      console.log("url:", url);

      let img = document.createElement("img");
      img.setAttribute("class", "thnImg");

      img.src = url;

      let title = snippet.title;

      let h4 = document.createElement("h4");

      h4.innerText = title.substring(0, 70);

      let video_data = {
        snippet: snippet,
        videoId: videoId,
      };
      //if (video_data.videoId === undefined) {

      // }
      div.onclick = () => {
        if (video_data.videoId === undefined) {
          let video_data = {
            snippet: snippet,
            id,
          };
          showVideo(video_data);
        } else {
          showVideo(video_data);
        }
        console.log(video_data.videoId);
      };

      div.append(img, h4);

      videos.append(div);
    });
  }

  const showVideo = (video_data) => {
    console.log("video_data:", video_data);

    localStorage.setItem("clicked_video", JSON.stringify(video_data));

    window.open(`clickedVideo.html`);

    //alert("clicked on a video");
  };
</script>
